## 项目场景题

### 管道网页端

#### webworker相关

多线程机制（浏览器提供），不阻塞主线程。

用途：大量经纬度转换（84转02），为了避免影响主线程的性能

具体实施：

- postMessage将数据从主线程传递到webworker；onmessage事件监听worker返回的结果；
- 在worker.js中，经纬度转换的代码封装成函数
- 结束之后，调用worker.terminate()来主动销毁Worker实例，防止资源泄露

好处：

- 避免阻塞ui线程、提高并发、减少页面卡顿

优化：

- 数据量庞大的时候，直接传输会导致性能下降。
  - 解决方法：数据分页或分块处理

#### 优化实时告警点

减少重复渲染：

- 确保同一个告警点没有变化的情况下不会被渲染
- 标记管理

使用requestAnimationFrame:

- 减少不必要的渲染
- 与浏览器渲染同步

限流：当告警点持续涌入的时候，使用限流来限制单位时间内最大的绘制次数。

#### 地图底图渲染白屏

问题：WebGL上下文的资源耗尽或者缓冲区限制导致。WebGL渲染需要在GPU上分配内存，如果大量图形短时间内进行渲染，会导致GPU缓冲区超出容量，触发错误。

解决方法：

- 分批渲染：设置每次批量渲染的数量，结合requestAnimationFrame将渲染过程分散到多个帧；
- 使用 CanvasLayer 或 WebGLLayer 渲染标记